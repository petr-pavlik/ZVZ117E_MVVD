[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Metody vyhodnocování vodohospodářských dat",
    "section": "",
    "text": "1 Úvodem\nNa těchto stránkách se nachází průvodce ke cvičením z kurzu ZVZ117E Metody vyhodnocování vodohospodářských dat, vyuřovaném na Fakultě životního prostředí České zemědělské univerzity. Jeho obsahem jsou materiály ke všem cvičením spolu se zkrácenou teoretickou částí. Text nemá za ambici komplexní teoretický výklad látky - nenahrazuje ani přednášky ani skripta. Jedná se o průvodce cvičeními, nicméně pro potřeby cvičení teorii ve zkrácené podobě připomene.\nVzhledem k tomu, že je tento text orientován na osvojení základních postupů při statistickém zpracování dat, jednotlivé postupy jsou voleny jako nejjednodušší možné. Obecně tedy platí, že veškeré úkony jsou prováděny se zvoleným didaktickým cílem, který je vytyčen na začátku každého cvičení. Tentýž kód je často možné zapsat elegantněji, nebo efektivněji s pomocí pokročilejších nástrojů, na jejichž existenci je čtenář občas doplňkově upozorněn."
  },
  {
    "objectID": "index.html#doporučená-literatura",
    "href": "index.html#doporučená-literatura",
    "title": "Metody vyhodnocování vodohospodářských dat",
    "section": "1.1 Doporučená literatura",
    "text": "1.1 Doporučená literatura\nPopisná statistiky je v cvičena v rozsahu textu Puš (2007) a Jarušková (2006) obsahuje úvod do matematické statistiky.\nK jazyku R je\n\n\n\n\nJarušková, Daniela. 2006. Pravděpodobnost a matematická statistika. Česká technika-nakladatelství ČVUT.\n\n\nPuš, Vladimír. 2007. Popisná statistika. Česká zemědělská univerizita v Praze."
  },
  {
    "objectID": "intro.html#typografické-konvence",
    "href": "intro.html#typografické-konvence",
    "title": "2  Organizace textu",
    "section": "2.1 Typografické konvence",
    "text": "2.1 Typografické konvence\nZdrojový kód v textu je barevně odlišen a jednotlivé úkony jsou v kódu doprovozeny číslovanými komentáři v kroužku, které se aktivují najetím kurzoru myši. V případě, že zdrojový kód obsahuje pouze jeden výraz k vyhodnocení, je vždy výstup uveden přímo pod ním.\n\n\nKód\n1cat(\"Příklad výrazu a jeho vyhodnocení\")\n\n\n\n1\n\nToto je komentář.\n\n\n\n\nPříklad výrazu a jeho vyhodnocení\n\n\nNěkdy je nutné provést vyhodnocení více po sobě jdoucích výrazů a text byl zbytečně nafukován. V takovém případě je výstup zachován přímo v okně zdrojového kódu a je uvozen dvěma po sobě jdoucími znaky \\(\\#\\#\\).\n\n\nKód\n1mean(1:10)\nmedian(1:10)\nsd(1:10)\n## [1] 5.5\n## [1] 5.5\n## [1] 3.02765\n\n\n\n1\n\nSjednocené výstupy v bloku kódu.\n\n\n\n\nPokud se kód nachází uvnitř textu, je opět barevně odlišen a vysázen neproporcionálním písmem. Přičemž funkce je vždy uvedena s příslušnými závorkami a text, který je v kódu navíc, je vždy ohraničen znaky \\(&lt;\\) a \\(&gt;\\). Příkladem budiž mean(x = &lt;vektor čísel&gt;)."
  },
  {
    "objectID": "intro.html#verze",
    "href": "intro.html#verze",
    "title": "2  Organizace textu",
    "section": "2.2 Verze",
    "text": "2.2 Verze\nTento text byl vytvořen s pomocí verze R 4.4.0 a jmenných prostorů balíků ve verzích:\n\n\n\n\n\n\nVersion\n\n\n\n\nbase\n4.4.0\n\n\ncli\n3.6.3\n\n\ncompiler\n4.4.0\n\n\ndatasets\n4.4.0\n\n\ndigest\n0.6.36\n\n\nevaluate\n0.24.0\n\n\nfastmap\n1.2.0\n\n\nglue\n1.7.0\n\n\ngraphics\n4.4.0\n\n\ngrDevices\n4.4.0\n\n\nhtmltools\n0.5.8.1\n\n\nhtmlwidgets\n1.6.4\n\n\njsonlite\n1.8.8\n\n\nknitr\n1.48\n\n\nlifecycle\n1.0.4\n\n\nmagrittr\n2.0.3\n\n\nmethods\n4.4.0\n\n\nrlang\n1.1.4\n\n\nrmarkdown\n2.27\n\n\nrstudioapi\n0.16.0\n\n\nstats\n4.4.0\n\n\nstringi\n1.8.4\n\n\nstringr\n1.5.1\n\n\ntools\n4.4.0\n\n\nutils\n4.4.0\n\n\nxfun\n0.46"
  },
  {
    "objectID": "01_uvod_do_R_1.html#zakládáme-projekt",
    "href": "01_uvod_do_R_1.html#zakládáme-projekt",
    "title": "3  R & RStudio",
    "section": "3.1 Zakládáme projekt",
    "text": "3.1 Zakládáme projekt\nJe vhodné seskupovat svoji práci do zv. projektů - ucelených souborů skriptů, dat a výstupů - podle jednotlivých projektů, kterým se věnuji.\n\nPři spuštěném programu z hlavní nabídky vybereme File &gt; New Project…\n\nVybereme New Directory a zvolíme New Project. Ostatní možnosti v tomto kurzu využívate nebudeme.\n\nProjektu je dále nutné zadat název Directory name. Pokud používate verzovací systém Git, můžete zaškrtnout volbu Create a git repository. V tomto kurzu používat nebudeme.\n\nPo úspěšném založení projektu by se mělo zobrazit hlavní okno programu s přednastvenými panely. V nastavení učeben ČZU odpovídá rozvržení 1. obrázku."
  },
  {
    "objectID": "01_uvod_do_R_1.html#hlavní-okna-a-panely",
    "href": "01_uvod_do_R_1.html#hlavní-okna-a-panely",
    "title": "3  R & RStudio",
    "section": "3.2 Hlavní okna a panely",
    "text": "3.2 Hlavní okna a panely"
  },
  {
    "objectID": "01_uvod_do_R_1.html#pracovní-postup-a-jeho-opakovatelnost",
    "href": "01_uvod_do_R_1.html#pracovní-postup-a-jeho-opakovatelnost",
    "title": "3  R & RStudio",
    "section": "3.3 Pracovní postup a jeho opakovatelnost",
    "text": "3.3 Pracovní postup a jeho opakovatelnost\nR bohužel umožnuje připínat a odepínat data.frame pomocí funkcí attach() a detach(), na které je vhodné ihned po přečtení této věty zapomenout.\n\n\nKód\n?ls\nrm(list = ls())\n?objects\n\n\n\n\nKód\nl &lt;- list(A = 1:3, B = 3:5)\nattach(l)\nA\n\n\n[1] 1 2 3"
  },
  {
    "objectID": "02_uvod_do_R_2.html#nápověda",
    "href": "02_uvod_do_R_2.html#nápověda",
    "title": "4  Opakovaní R",
    "section": "4.1 Nápověda",
    "text": "4.1 Nápověda\nZadává se do konzole ve tvaru help(&lt;jméno funkce&gt;), nebo &lt;jmeno funkce&gt;. Pokud bychom se chtěli podívat přímo do kódu funkce, také je to možné, jméno funkce pouze vepíšeme do konzole bez závorek, případně použijeme příkazu View(&lt;jmeno funkce&gt;). Kromě toho existuje v R také help.search(&lt;jméno funkce&gt;) pod zkratkou ??, jež hledá fulltextovou nápovědu napříč nainstalovanými balíčky. Dále je ještě možné prohledat mailing list jazyka R pomocí funkce RSiteSearch(), která otevře nové okno předdefinovaného prohlížeče. Dále jsou velmi užitečné tematicky ucelené karty nápověd: ?Logical, ?Constants, ?Control, ?Arithmetic, ?Syntax, ?Special a další.\n\n\n\n\n\n\nÚloha\n\n\n\n\nVyhledejte nápovědu k DateTimeClasses.\na) Co reprezentují třídy POSIXct a POSIXlt?\nb) Jaký je mezi nimi rozdíl?\nc) Nalezněte funkci pro výpočet \\(5!\\)"
  },
  {
    "objectID": "02_uvod_do_R_2.html#jmenné-konvence",
    "href": "02_uvod_do_R_2.html#jmenné-konvence",
    "title": "4  Opakovaní R",
    "section": "4.2 Jmenné konvence",
    "text": "4.2 Jmenné konvence\nObjekty, které vznikají při práci s R musí splňovat následující jmenné konvence. Název objektu nezačíná číslovkou nebo operátorem. Název se neshoduje se žádným klíčovým slovem rovněž se název neshoduje s žádnou běžně používanou funkcí.\n\nKlíčová slova\nif, else, repeat, while, function, for, in, next, repeat, break, TRUE, FALSE, NULL, Inf, NaN, NA, NA_integer_, NA_real_, NA_complex_, NA_character_, a speciální znak: _\nNedoporučuje se vkládat do názvu proměnné tečku, např. morava.prutoky.\n\n\n\n\n\n\nÚloha\n\n\n\n\nIntuitivně by nás mohlo vést nahrát data do proměnné data. Je to chybný postup, neboť data() je funkce zpřístupňující datové sady, kterou jsou součástí instalace. Vyzkoušejte.\n\n\n\n\n\nPříklady nevhodných proměnných\naaa, Morávka průtok [m/s], moje.proměnná\nŽádné z těchto jmen proměnných není proti"
  },
  {
    "objectID": "02_uvod_do_R_2.html#uvozovky-a-závorky",
    "href": "02_uvod_do_R_2.html#uvozovky-a-závorky",
    "title": "4  Opakovaní R",
    "section": "4.3 Uvozovky a závorky",
    "text": "4.3 Uvozovky a závorky\nPředstavují párové znaky jazyka R. Závorky se používají trojího typu: kulaté, hranaté a složené a všechny mají jasně vymezné pole působnosti.\n\n() se používají vždy se jménem funkce a uvozují prostor ve kterém se parametrizují argumenty funkce.\n\n[] se vždy pojí se jménem objektu - vektoru, pole, listu, … a vymezují výběr z daného objektu.\n\n{} ohraničují blok kódu, který se má vykonat v celku.\n\n\nUvozovky uvozují textové řetězce. Lze používat jak dvojté \" tak jednoduché ' uvozovky zcela zástupně, je pouze třeba uzavírat shodným typem.\n\n\nKód\n\"Správně\"\n\"Špatně'\n\n\n\n\n\n\n\n\nÚloha\n\n\n\n\nZadejte špatnou variantu z kódu výše do konzole a sledujte chování prostředí. Co vyjadřuje znak +?"
  },
  {
    "objectID": "02_uvod_do_R_2.html#aritmetické-operace",
    "href": "02_uvod_do_R_2.html#aritmetické-operace",
    "title": "4  Opakovaní R",
    "section": "4.4 Aritmetické operace",
    "text": "4.4 Aritmetické operace\n\n\nKód\n11 + 1\n22 - 1\n31 * 3\n1 * (-1)\n41 / 6\n510 %% 3\n67 %/% 3\n710 ** 3\n810 %*% 3\n9sum(1:10)\n10prod(1:10)\n11cumsum(1:10)\n12cumprod(1:10)\n\n\n\n1\n\nSčítání\n\n2\n\nOdečítání\n\n3\n\nNásobení\n\n4\n\nDělení\n\n5\n\nModulo\n\n6\n\nCeločíselné dělení\n\n7\n\nMocninné operace\n\n8\n\nMaticové násoobení\n\n9\n\n\\(\\sum\\) prvků z rozsahu\n\n10\n\n\\(\\Pi\\) prvků z rozsahu\n\n11\n\nKumulativní součet prvků z rozsahu\n\n12\n\nKumulativní produkt prvků z rozsahu"
  },
  {
    "objectID": "02_uvod_do_R_2.html#operátory",
    "href": "02_uvod_do_R_2.html#operátory",
    "title": "4  Opakovaní R",
    "section": "4.5 Operátory",
    "text": "4.5 Operátory\nKromě aritmetických operátorů, zmíněných ?sec-aritmeticke-operace\n\n\nKód\n1&lt;\n2&gt;\n3&gt;=\n4&lt;=\n5==\n6!=\n7&\n8&&\n9|\n10||\n11xor(x)\n12isTRUE(x)\n13any()\n14all()\n15%in%\n16setdiff(x, y)\n\n\n\n1\n\nMenší než\n\n2\n\nVětší než\n\n3\n\nVětší nebo rovno\n\n4\n\nMenší nebo rovno\n\n5\n\nRovno\n\n6\n\nNerovno\n\n7\n\nLogické “a”\n\n8\n\nLogické “a” přes vektor\n\n9\n\nLogické “nebo”\n\n\n10\n\nLogické “nebo” přes vektor\n\n11\n\nNegace\n\n12\n\nJe \\(x\\) “pravda”?\n\n13\n\nJe něco z obsahu “pravda”?\n\n14\n\nJe vše z obsahu “pravda”?\n\n15\n\nJe něco obsaženo v?\n\n16\n\nChybí něco něco z obsahu v?\n\n\n\n\n\n\n\n\n\n\nÚloha\n\n\n\n\nPoužite k výpočtu operátory:\na) Zjistěte, zda je číslo 1109388 dělitelné 7.\nb) Do vektoru \\(\\mathbf{\\mathrm{a}}\\) uložte násobky 3 v rozsahu \\(\\langle-121;30\\rangle\\) a \\(\\mathbf{\\mathrm{b}}\\) násobky 7 v rozmezí\nc) Vypište hodnoty"
  },
  {
    "objectID": "02_uvod_do_R_2.html#základní-datové-struktury",
    "href": "02_uvod_do_R_2.html#základní-datové-struktury",
    "title": "4  Opakovaní R",
    "section": "4.6 Základní datové struktury",
    "text": "4.6 Základní datové struktury\nZákladní datové struktury rozlišujeme na atomické (homogenní) a heterogenní datové struktury.\n\n4.6.1 Homogenní datové struktury\nHomogenní datové struktury obsahují atomické vektory, faktory, matice a pole. Název je odvozen od jejich omezení v podvýběru obsahovat pouze typ sebe sama tzn. podvýběr matice může být opět pouze matice.\n\n4.6.1.1 Vektor vector\nVektor je v jazyce R základní stavební strukturou. Může nabývat jakéhokoliv datového typu, nicméně všechny prvky v daném vektoru jsou právě jednoho typu, čímž rozumíme, že je tato struktura tzv. homogenní. Vektor je možné vytvořit mnoha způsoby, mezi nejčastější patří funkce vector(mode = \"numeric\", length = 10) a funkce c(), případně vzniká pomocí opetárorů [ nebo [[.\nS vektory se pojí důležité pravidlo - recyklace hodnot.\n\n\nKód\nv &lt;- c(1.4, 2.0, 6.1, 2.7)\nu &lt;- c(2.0, 1.3)\n1u + v\n2u * v\n\n\n\n1\n\nSčítám vektory přičemž délka jednoho je násobkem délky druhého.\n\n2\n\nNásobím vektory přičemž délka jednoho je násobkem délky druhého.\n\n\n\n\n[1] 3.4 3.3 8.1 4.0\n[1]  2.80  2.60 12.20  3.51\n\n\n\nPráce s vektory\n\n\nKód\n1x &lt;- 1:10\nx &lt;- seq(10:1)\nx &lt;- vector(mode = \"numeric\", length = 10)\nx &lt;- replicate(n = 10, expr = eval(2))\nx &lt;- sample(x = 10, size = 10, replace = TRUE)\nx &lt;- rep(x = 15, times = 2)\n\n\n\n1\n\nTvorba vektoru \\(\\boldsymbol{\\mathrm{x}}\\) různými úkony. Použití sekvence, repetice, opakování a vzorkování.\n\n\n\n\n\n\n\n4.6.1.2 Matice matrix\nRozšířením dimenze vektoru vznikne matice nebo obecně pole.\n\n\nKód\nx &lt;- c(1:10)\ndim(x) &lt;- c(2, 5)\nx\n\n\n     [,1] [,2] [,3] [,4] [,5]\n[1,]    1    3    5    7    9\n[2,]    2    4    6    8   10\n\n\n\n\n\nFunkce\nÚkon\n\n\n\n\nnrow(), nco()\npočet řádků, sloupců matice\n\n\ndim()\nřádky \\(\\times\\) sloupce matice\n\n\ndet()\ndeteminant matice\n\n\neigen()\nvlastní čísla a vlastní vektory matice\n\n\n\n\\[\nA =\n\\begin{bmatrix}\n1\\\\\n1\\\\\n1\\\\\n1\\\\\n\\end{bmatrix}\n\\]\n\n\nKód\nA &lt;- matrix(data = seq(from = 1, to = 16, by = 2), nrow = 4)\n1str(A)\n2dim(A)\n3svd(A)\n4diag(A)\n# sweep(x = A, MARGIN = 1, STATS = mean)\n##  num [1:4, 1:2] 1 3 5 7 9 11 13 15\n## [1] 4 2\n## $d\n## [1] 25.930394  2.759471\n## \n## $u\n##            [,1]       [,2]\n## [1,] -0.3396065 -0.7646355\n## [2,] -0.4383147 -0.3284512\n## [3,] -0.5370229  0.1077330\n## [4,] -0.6357311  0.5439173\n## \n## $v\n##            [,1]       [,2]\n## [1,] -0.3389761  0.9407950\n## [2,] -0.9407950 -0.3389761\n## \n## [1]  1 11\n\n\n\n1\n\nStruktura objektu\n\n2\n\nDimenze matice\n\n3\n\nSingulární rozklad\n\n4\n\nPrvky na diagonále matice\n\n\n\n\n\n\n\n4.6.2 Heterogenní datové struktury\nZa heterogenní struktury se označují ty, které mohou uchovávat dva a více prvků rozdílného typu současně. Z těch základních to jsou data.frame a list, dále pak S4, nebo R6 třídy, případně další uživatelem vytvořené struktury.\n\n4.6.2.1 Datová tabulka data.frame\ndata.frame je de facto vektor stejně dlouhých vektorů, které kromě toho, že musí být shodné délky, mohou být rozdílného typu.\n\n\nKód\nDF &lt;- data.frame(name = letters[1:5], \n                 value = rnorm(5))\nDF\n##   name       value\n## 1    a -2.89168307\n## 2    b  3.03219933\n## 3    c -0.01493429\n## 4    d -0.26301710\n## 5    e -0.32378350\nDF[\"name\"]        # podvýběr do data.frame\n##   name\n## 1    a\n## 2    b\n## 3    c\n## 4    d\n## 5    e\nDF[[\"name\"]]      # podvýběr do vektoru\n## [1] \"a\" \"b\" \"c\" \"d\" \"e\"\nDF[, \"name\"]      # podvýběr do vektoru\n## [1] \"a\" \"b\" \"c\" \"d\" \"e\"\n\n\nPráce uvnitř data.frame\n\n\nKód\nDF &lt;- data.frame(\n  mon = rep(month.abb, \n            times = c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)), \n  value = rnorm(365), \n  yr = 2001)\nstr(DF)\n## 'data.frame':    365 obs. of  3 variables:\n##  $ mon  : chr  \"Jan\" \"Jan\" \"Jan\" \"Jan\" ...\n##  $ value: num  -0.249 1.615 -0.881 0.645 0.299 ...\n##  $ yr   : num  2001 2001 2001 2001 2001 ...\nnames(DF)\n## [1] \"mon\"   \"value\" \"yr\"\nnrow(DF)\n## [1] 365\nncol(DF)\n## [1] 3"
  },
  {
    "objectID": "02_uvod_do_R_2.html#řídící-struktury",
    "href": "02_uvod_do_R_2.html#řídící-struktury",
    "title": "4  Opakovaní R",
    "section": "4.7 Řídící struktury",
    "text": "4.7 Řídící struktury\n\n4.7.1 Podmínky\n\n\nKód\nA &lt;- 1\nif(A &gt;= 1) {\n  cat(\"A je větší nebo shodné s 1.\")\n}\n\n\nA je větší nebo shodné s 1.\n\n\n\n\nKód\nA &lt;- 5\n1if(A &gt;= 2) {\n  cat(\"A je větší nebo shodné s 2.\")\n} else if(A &gt; 2) {\n  cat(\"A je větší než 2.\")\n}\n\n\n\n1\n\nŘetěz podmínek se uzavře v momentě, kdy je výraz v závorce poprvé vyhodnocen jako pravdivý.\n\n\n\n\nA je větší nebo shodné s 2.\n\n\n\n\n4.7.2 Cykly\n\n4.7.2.1 for z definovaného rozsahu\n\n\nKód\nfor(i in 1:4) {\n  cat(i, \"\\n\")\n}\n\n\n1 \n2 \n3 \n4 \n\n\n\n\n4.7.2.2 while s pomocí podmínky\n\n\nKód\ni &lt;- 1\nwhile(i &lt; 4) {\n  cat(i, \"\\n\")\n  i &lt;- i + 1\n}\n\n\n1 \n2 \n3 \n\n\n\n\n4.7.2.3 repeat s únikovou sekvencí\n\n\nKód\ni &lt;- 1\nrepeat({\n  cat(i, \"\\n\")\n  i &lt;- i + 1\n  if(i &gt;= 4) break\n})\n\n\n1 \n2 \n3 \n\n\n\n\n\n\n\n\nCvičení\n\n\n\n\nVyhodnoťte s pomocí R následující výrazy:\na) \\(1 + 3 \\cdot (2 / 3)\\:\\mathrm{mod}\\:3\\)\nb) \\(\\left(\\dfrac{2}{35}\\right)^{0.5} \\cdot 3 \\cdot (2 / 3)\\)\nc) \\(\\sum\\limits_{i = 1}^{53}x_i\\)\nd) \\(\\dfrac{-\\infty}{0}\\), \\(\\dfrac{-\\infty}{\\infty}\\), \\(\\dfrac{0}{0}\\)\ne) \\(\\dfrac{\\sin(2.3)}{\\cos(\\pi)}\\)\nf) \\(20!\\)\ng) \\(\\int_{0}^{3\\pi} \\sin(x) dx\\)\nProveďte:\na) Vytvořte vektor hodnot od \\(100\\) do \\(1\\) sestupně, využijte nápovědu k funkci seq().\nb) Spočtěte rozdíl, matic \\(\\boldsymbol{\\mathrm{A}}\\), \\(\\boldsymbol{\\mathrm{B}}\\). \\[\\boldsymbol{\\mathrm{A}} = \\left(\n  \\begin{matrix}\n  2 & 2 & 5\\\\\n  9 & 2 & 7\\\\\n  1 & 3 & 18\\\\\n  \\end{matrix}\n  \\right),\\qquad\n  \\boldsymbol{\\mathrm{B}} = \\left(\n  \\begin{matrix}\n  5 & 4 & 5\\\\\n  -7 & 2 & 4\\\\\n  10 & 1 & 5\\\\\n  \\end{matrix}\n  \\right)\n  \\]\nc) Spočítejte inverzní matici k matici \\(\\boldsymbol{\\mathrm{A}}\\). Najděte vhodnou funkci s pomocí nápovědy.\nd) S pomocí hodnot TRUE/FALSE vytvořte matici \\(\\boldsymbol{\\mathrm{M}}(3,3)\\), změňte typ prvku na pozici \\(\\boldsymbol{\\mathrm{M}}[1, 1]\\) na textový řetězec. Ovlivní tato změna ostatní prvky v matici?"
  },
  {
    "objectID": "02_uvod_do_R_2.html#práce-s-daty",
    "href": "02_uvod_do_R_2.html#práce-s-daty",
    "title": "4  Opakovaní R",
    "section": "4.8 Práce s daty",
    "text": "4.8 Práce s daty\nChybějící záznamy a speciální numerické případy NA, NaN, NULL, Inf, -Inf jsou hodnoty, které mohou vzniknout například jako výsledek početního úkonu, nebo špatného importu dat. Výraz NA je tvořen v datovém typu logical, nejméně náročném na paměť. Jinak je možné specifikovat chybějící hodnotu ve všech ostatních datových typech NA_real_ (odpovídá double), NA_integer_, NA_complex_ a NA_character_, které je vhodné využít zejména při vytváření datového rámce s přesně zadaným typem sloupců. NULL je návratová hodnota mnoha funkcí a výrazů, reprezentuje prázdný objekt. Výsledky NaN a ±Inf pochází z aritmetických operací \\(\\dfrac{1}{0}\\) resp. \\(\\dfrac{\\pm0}{1}\\) . na.omit(), is.na(), complete.cases().\n\n\nKód\nglobal_temperatures &lt;- read.csv(file = \"./data/JonesGlobalT.csv\", row.names = 1)\nhead(x = global_temperatures, n = 5)\n\n\n  YEAR    JAN    FEB    MAR    APR    MAY    JUN    JUL    AUG    SEP    OCT\n1 1850 -0.702 -0.284 -0.732 -0.570 -0.325 -0.213 -0.128 -0.233 -0.444 -0.452\n2 1851 -0.303 -0.362 -0.485 -0.445 -0.302 -0.189 -0.215 -0.153 -0.108 -0.063\n3 1852 -0.308 -0.477 -0.505 -0.559 -0.209 -0.038 -0.016 -0.195 -0.125 -0.216\n4 1853 -0.177 -0.330 -0.318 -0.352 -0.268 -0.179 -0.059 -0.148 -0.409 -0.359\n5 1854 -0.360 -0.280 -0.284 -0.349 -0.230 -0.215 -0.228 -0.163 -0.115 -0.188\n     NOV    DEC ANNUAL\n1 -0.190 -0.268 -0.375\n2 -0.030 -0.067 -0.223\n3 -0.187  0.083 -0.224\n4 -0.256 -0.444 -0.271\n5 -0.369 -0.232 -0.246\n\n\n\n\nKód\n1global_temperature_yr &lt;- aggregate(x = . ~ YEAR,\n                                   FUN = mean,\n                                   data = global_temperatures)\nhead(x = global_temperature_yr, n = 5)\n\n\n\n1\n\nAgregace dat do průměrů za roční období.\n\n\n\n\n  YEAR    JAN    FEB    MAR    APR    MAY    JUN    JUL    AUG    SEP    OCT\n1 1850 -0.702 -0.284 -0.732 -0.570 -0.325 -0.213 -0.128 -0.233 -0.444 -0.452\n2 1851 -0.303 -0.362 -0.485 -0.445 -0.302 -0.189 -0.215 -0.153 -0.108 -0.063\n3 1852 -0.308 -0.477 -0.505 -0.559 -0.209 -0.038 -0.016 -0.195 -0.125 -0.216\n4 1853 -0.177 -0.330 -0.318 -0.352 -0.268 -0.179 -0.059 -0.148 -0.409 -0.359\n5 1854 -0.360 -0.280 -0.284 -0.349 -0.230 -0.215 -0.228 -0.163 -0.115 -0.188\n     NOV    DEC ANNUAL\n1 -0.190 -0.268 -0.375\n2 -0.030 -0.067 -0.223\n3 -0.187  0.083 -0.224\n4 -0.256 -0.444 -0.271\n5 -0.369 -0.232 -0.246\n\n\n\n\nKód\npar(mfrow = c(1, 2))\nwith(data = global_temperature_yr, expr = plot(YEAR, JAN, type = \"l\"))\nwith(data = global_temperature_yr, \n     expr = boxplot(ANNUAL, horizontal = TRUE))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCvičení\n\n\n\n\nNahrajte data do prostředí s pomocí vhodně parametrizované read.___() funkce.\n\nDoplňte hydrologický rok.\n\nProveďte agregaci dat průměrem pro jednotlivé měsíce.\n\nVyneste do grafu pomocí funkce plot()."
  },
  {
    "objectID": "03_grafy.html#funkce-curve",
    "href": "03_grafy.html#funkce-curve",
    "title": "5  Grafický výstup",
    "section": "5.1 Funkce curve()",
    "text": "5.1 Funkce curve()\nCurve je funkce, která se uplatní při tvorbě symbolických grafů matematických funkcí, kdy není třeba parametrizovat argument x.\n\n\nKód\ncurve(expr = tanh(x),\n      from = -pi, \n      to = pi)"
  },
  {
    "objectID": "03_grafy.html#funkce-plot",
    "href": "03_grafy.html#funkce-plot",
    "title": "5  Grafický výstup",
    "section": "5.2 Funkce plot()",
    "text": "5.2 Funkce plot()\nplot(x, y, ...) je základní S3 generická funkce, jejíž metody umožňují použití na široké množství objektů. Začneme s použitím na vektor z datasetu dfr.\n\n\nKód\n1plot(dfr$Y)\n\n\n\n1\n\nFunkce má věšinu svých argumentů parametrizovaných v přednastavenými hodnotami, nebo hodnotami novodvozenými od parametru. Vidíme tak, že osa \\(y\\) je pojmenována po vstupním parametru. V celém znění funkce vypadá následovně:~~~ plot(x, y = NULL, type = “p”, xlim = NULL, ylim = NULL, log = ““, main = NULL, sub = NULL, xlab = NULL, ylab = NULL, ann = par(”ann”), axes = TRUE, frame.plot = axes, panel.first = NULL, panel.last = NULL, asp = NA, xgap.axis = NA, ygap.axis = NA, …) ~~~\n\n\n\n\n\n\n\n\n\n\n\n\n\nKód\n1plot(x = dfr$X,\n     y = dfr$Y,\n2     type = \"b\",\n3     col = \"gray10\",\n4     pch = 21,\n5     bg = \"#4a6777\",\n6     ylim = c(-abs(1.25 * min(dfr$Y)),\n              1.25 * max(dfr$Y)),\n7     xlab = \"\",\n     ylab = \"Value\",\n8     main = \"Y~X vztah\",\n9     sub = Sys.Date())\n10legend(x = \"topright\",\n11       fill = \"#4a6777\",\n12       pch = 21,\n13       legend = c(\"Y\"),\n14       box.col = NA,\n15       lty = 1,\n16       col = \"gray10\")\n\n\n\n1\n\nZákladní proměnné \\(X\\) a \\(Y\\) pro typ grafu.\n\n2\n\nVolba typu grafu \"b\" označuje body protnuté spojnicí.\n\n3\n\nVolba barvy popředí znaku bod/přímka.\n\n4\n\nVolba charakteru bodového znaku.\n\n5\n\nVolba barvy pozadí znaku umožňujícího výplň - bod.\n\n6\n\nZměna rozsahu osy \\(y\\).\n\n7\n\nZměna názvu os.\n\n8\n\nZnění hlavního nadpisu.\n\n9\n\nPodnadpis dtto.\n\n10\n\nPokračujeme nastavením umístění legendy.\n\n11\n\nVýplň prvku v legendě.\n\n12\n\nTyp prvku v legendě.\n\n13\n\nNázev prvku v legendě.\n\n14\n\nVolba barvy ohraničení legendy\n\n15\n\nVolba typu spojnice (1 = plná čára)\n\n16\n\nVolba barvy popředí prvku legendy\n\n\n\n\n\n\n\n\n\n\n\n\n\nKód\n1with(data = dfr,\n2     expr = {\n       plot(x = X, y = Y)\n       lines(x = X, y = Y)\n       }\n     ) \n\n\n\n1\n\nFunkce with() umožňuje zavolání funkce uvedené v arugmentu expr na proměnných v data.frame. Odpadá opakované psaní prefixu datové sady (zde dfr$___)\n\n2\n\nArgument expr může obsahovat i blok kódu {...}"
  },
  {
    "objectID": "03_grafy.html#volba-barev",
    "href": "03_grafy.html#volba-barev",
    "title": "5  Grafický výstup",
    "section": "5.3 Volba barev",
    "text": "5.3 Volba barev\nVýpis všech předdefinovaných barev1 lze získat příkazem colors().\n\n\nKód\ncolors()[1:10]\n\n\n [1] \"white\"         \"aliceblue\"     \"antiquewhite\"  \"antiquewhite1\"\n [5] \"antiquewhite2\" \"antiquewhite3\" \"antiquewhite4\" \"aquamarine\"   \n [9] \"aquamarine1\"   \"aquamarine2\""
  },
  {
    "objectID": "03_grafy.html#matematická-sazba-v-grafech",
    "href": "03_grafy.html#matematická-sazba-v-grafech",
    "title": "5  Grafický výstup",
    "section": "5.4 Matematická sazba v grafech",
    "text": "5.4 Matematická sazba v grafech"
  },
  {
    "objectID": "03_grafy.html#vytváříme-layout",
    "href": "03_grafy.html#vytváříme-layout",
    "title": "5  Grafický výstup",
    "section": "5.5 Vytváříme layout",
    "text": "5.5 Vytváříme layout\nJednoduchý pravidelný layout můžeme vytvořit změnou parametrů okna grafického výstupu pomocí funkce par()\n\n5.5.1 Sazba pomocí par()\n\n\nKód\n1par(mfrow = c(1, 2))\n2hist(dfr$X, main = \"X\", xlab = \"\")\nhist(dfr$Y, main = \"Y\", xlab = \"\")\n\n\n\n1\n\nOkno výstupu rozdělíme do dvou sloupců na jednom řádku.\n\n2\n\nPosléze voláme dva grafy, které postupně vyplní pole v daném okně.\n\n\n\n\n\n\n\n\n\n\n\n\n\n5.5.2 Sazba s funkcí layout() a matice\n\n\nKód\nlayout.show(\n  layout(\n    mat = matrix(\n      data = c(2, 2, 0,\n               1, 1, 3,\n               1, 1, 3), \n      nrow = 3, \n      ncol = 3, \n      byrow = TRUE)))"
  },
  {
    "objectID": "03_grafy.html#ukládáme-do-souboru",
    "href": "03_grafy.html#ukládáme-do-souboru",
    "title": "5  Grafický výstup",
    "section": "5.6 Ukládáme do souboru",
    "text": "5.6 Ukládáme do souboru"
  },
  {
    "objectID": "03_grafy.html#footnotes",
    "href": "03_grafy.html#footnotes",
    "title": "5  Grafický výstup",
    "section": "",
    "text": "Předdefinovaných barev je celkem 657.↩︎"
  },
  {
    "objectID": "04_popisna.html#míry-polohy",
    "href": "04_popisna.html#míry-polohy",
    "title": "6  Popisná statistika",
    "section": "6.1 Míry polohy",
    "text": "6.1 Míry polohy\n\n6.1.1 Minimum, maximum\nPro oba extrémy jsou v R stejnojmenné funkce.\n\\[\n\\max(x)\\\\\n\\min(x)\\\\\n\\min(x) - \\max(x)\n\\]\n\n\n\n6.1.2 Výběrový kvantil\n\n\nKód\n1t(sapply(X = 1:7, FUN = function(i) quantile(x)))\n\n\n\n1\n\nVyužití anonymní funkce function(i) vektorizované pro rozsah hodnot 1:7 na pozici type ve funkci quantile()\n\n\n\n\n        0%     25%   50%  75% 100%\n[1,] -2.21 -0.4375 0.255 0.71  1.6\n[2,] -2.21 -0.4375 0.255 0.71  1.6\n[3,] -2.21 -0.4375 0.255 0.71  1.6\n[4,] -2.21 -0.4375 0.255 0.71  1.6\n[5,] -2.21 -0.4375 0.255 0.71  1.6\n[6,] -2.21 -0.4375 0.255 0.71  1.6\n[7,] -2.21 -0.4375 0.255 0.71  1.6\n\n\n\n\nAritmetický průměr\nAritmetický průměr hodnot výběrového souboru.\n\\[\n  \\bar{x} = \\frac{1}{n}(x_1 + x_2 + \\ldots + x_n) = \\dfrac{1}{n}\\sum\\limits_{i=1}^{n}x_i\n\\]\n\n6.1.2.1 Medián\nArtitmetický průměr hodnot na pozicích \\(\\frac{n}{2}\\) a \\(\\frac{n}{2+1}\\) v seřazeném souboru.\n\n\nKód\nmedian(x)\n\n\n[1] 0.255\n\n\n\n\n\n6.1.3 Modus\nZa modus se označuje nejčastěji se vyskytující hodnota v souboru. Cětnost výskytu u hodnot na reálné ose se nahrazuje buďto hustotou nebo\n\n\nKód\n1table(round(x = x, digits = 0))\n2table(cut(x, breaks = 10))\n3plot(density(x = x))\n\n\n\n1\n\nČetnosti po zaokrouhlení na celá čísla\n\n2\n\nČetnosti po rozdělení do 10 intervalů\n\n3\n\nHustota\n\n\n\n\n\n\n\n\n-2 -1  0  1  2 \n 2  5 12  9  2 \n\n  (-2.21,-1.83]   (-1.83,-1.45]   (-1.45,-1.07]  (-1.07,-0.686] (-0.686,-0.305] \n              2               1               0               2               4 \n (-0.305,0.076]   (0.076,0.457]   (0.457,0.838]    (0.838,1.22]      (1.22,1.6] \n              5               4               7               3               2 \n\n\n\n\n6.1.4 Harmonický průměr\nAritmetický průměr převrácených hodnot.\n\\[\n\\bar{x_h} = \\dfrac{n}{\\sum\\limits_{i=1}^{n}\\frac{1}{x_i}}\n\\]\n\n\n6.1.5 Průměr stupně \n\n\nKód\n1min(x)\nmax(x)\n2max(x) - min(x)\nrange(x)\n## [1] -2.21\n## [1] 1.6\n## [1] 3.81\n## [1] -2.21  1.60\n\n\n\n1\n\nStatistiky minimum & maximum\n\n2\n\nRozpětí"
  },
  {
    "objectID": "04_popisna.html#míry-variability",
    "href": "04_popisna.html#míry-variability",
    "title": "6  Popisná statistika",
    "section": "6.2 Míry variability",
    "text": "6.2 Míry variability\n\n6.2.1 Varianční rozpětí\nJe definováno jako rozdíl maxima a minima v souboru.\n\n\nKód\nrange(x)\n\n\n[1] -2.21  1.60\n\n\n\n\n6.2.2 Mezikvartilové rozpětí\nZatímco variační rozpětí popisuje rozpětí celého souboru, mezikvartilové rozpětí se omezuje na rozpětí poloviny hodnot, omezené \\(Q3\\) a \\(Q1\\) neboli \\(q_{75}\\) a \\(q_{25}\\).\n\\[\n\\mathrm{IQR} = Q3 - Q1\n\\]\n\n\nKód\nIQR(x)\n\n\n[1] 1.1475\n\n\n\n\n6.2.3 Rozptyl\n\\[\n     \\sigma^2 =\\sum\\limits_{1}^{n}\\sqrt{\\dfrac{1}{n}(x_i - \\bar{x})^2}\n\\]\n\n\n6.2.4 Směrodatná odchylka\n\\[\n   \\dfrac{1}{n}\\sqrt{\\sum\\limits_{i=1}^{n}(x_i - \\bar{x})^2}\n\\]\nRozptyl i směrodatnou odchylku spočteme v R pomocí funkcí var() (variance) a sd() standard deviation.\n\n\nKód\nvar(x)\n## [1] 0.8537454\nsd(x)\n## [1] 0.9239834\n\n\n\n\n6.2.5 Variační koeficient\n\\[\nV = 100 \\frac{s}{x}\n\\]\n\n\n6.2.6 Střední chyba aritmetického průměru\n\\[\ns_x = \\dfrac{s}{\\sqrt{n}}\n\\]\n\n\n\n\n\n\nCvičení\n\n\n\n\nNalezněte 10% kvantil a medián, z následujících hodnot\n\\(0.64\\), \\(0.98\\), \\(-0.49\\), \\(0.75\\), \\(-1.35\\), \\(1.65\\), \\(1.12\\), \\(-1.04\\), \\(1.05\\), \\(0.29\\), \\(-0.6\\), \\(-0.08\\), \\(1.45\\), \\(-1.87\\), \\(-0.07\\), \\(-0.02\\), \\(0.62\\), \\(0.01\\), \\(-0.26\\)\n\nCo"
  },
  {
    "objectID": "05_rozdeleni.html#distribuční-funkce-rozdělení",
    "href": "05_rozdeleni.html#distribuční-funkce-rozdělení",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.1 Distribuční funkce rozdělení",
    "text": "7.1 Distribuční funkce rozdělení\nRozdělení pravděpodobnosti náhodné veličiny lze jednoznačně popsat tzv. distribuční funkcí {Rovnice 7.1}.\n\\[\nF(x) = P(X\\leq x) = P(\\omega_i\\in\\Omega : X(\\omega_i)\\leq x)\n\\tag{7.1}\\]"
  },
  {
    "objectID": "05_rozdeleni.html#pravděpodobnostní-funkce-rozdělení",
    "href": "05_rozdeleni.html#pravděpodobnostní-funkce-rozdělení",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.2 Pravděpodobnostní funkce rozdělení",
    "text": "7.2 Pravděpodobnostní funkce rozdělení"
  },
  {
    "objectID": "05_rozdeleni.html#kvantilová-funkce",
    "href": "05_rozdeleni.html#kvantilová-funkce",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.3 Kvantilová funkce",
    "text": "7.3 Kvantilová funkce\nKvantilová funkce je inverzní funkcí k distribuční."
  },
  {
    "objectID": "05_rozdeleni.html#náhodná-čísla",
    "href": "05_rozdeleni.html#náhodná-čísla",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.4 Náhodná čísla",
    "text": "7.4 Náhodná čísla\nPro generování náhodných čísel lze použít rozdělení.\n\n\nKód\n1runif(n = 10, min = 0, max = 1)\n2rpois(n = 15, lambda = 2.4)\n\n\n\n1\n\nGenerování 10 čísel z rovnoměrného rozdělení z intervalu \\((0;1)\\)\n\n2\n\nGenerování 15 čísel z Poisonova rozdělení z intervalu \\((0;1)\\)\n\n\n\n\nGenerovaná čísla nejsou náhodná v pravém slova smyslu, ale označují se jako pseudonáhodná, neboť při jejich tvorbě se vychází z jiste sekvence čísel. Tuto sekvenci je možné přímo zvolit, čímž je zajištěna\n\n\nKód\nseed &lt;- .Random.seed\nhead(seed, 10)\n\n\n [1]       10403           2  2076997455 -1111822250   109910784  -612897213\n [7]   369432033  -929971888  1050974126  1924033881\n\n\n\n\nKód\nplot(.Random.seed)\n\n\n\n\n\n\n\n\n\n\n\nKód\nx &lt;- sample(x = 1:1e3, size = 1)\nset.seed(x)\nrunif(1)\n\nset.seed(x)\nrunif(2)\n\n\n[1] 0.3663231\n[1] 0.3663231 0.5313931"
  },
  {
    "objectID": "05_rozdeleni.html#empirické-vs.-teoretické-rozdělení",
    "href": "05_rozdeleni.html#empirické-vs.-teoretické-rozdělení",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.5 Empirické vs. teoretické rozdělení",
    "text": "7.5 Empirické vs. teoretické rozdělení"
  },
  {
    "objectID": "05_rozdeleni.html#diskrétní-rozdělení",
    "href": "05_rozdeleni.html#diskrétní-rozdělení",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.6 Diskrétní rozdělení",
    "text": "7.6 Diskrétní rozdělení\n\n\nKód\nx &lt;- rnorm(n = 10, mean = 1.25, sd = 5.36)\nmean(x)\n\n\n[1] 3.356051\n\n\nKód\nsum(x)\n\n\n[1] 33.56051\n\n\nKód\nmedian(x)\n\n\n[1] 1.998284\n\n\nKód\nIQR(x)\n\n\n[1] 5.721159\n\n\nKód\nfivenum(x)\n\n\n[1] -6.946134  1.067855  1.998284  7.165056 14.147672"
  },
  {
    "objectID": "05_rozdeleni.html#spojitá-rozdělení",
    "href": "05_rozdeleni.html#spojitá-rozdělení",
    "title": "7  Rozdělení pravděpodobnosti",
    "section": "7.7 Spojitá rozdělení",
    "text": "7.7 Spojitá rozdělení\n\n\nKód\ncurve(sin(x))\n\n\n\n\n\n\n\n\n\n\n\nCvičení\n\n\n\n\nGenerujte 10 čísel s pomocí normálního rozdělení s parametry \\(\\mu = 2.3\\) a \\(\\sigma = 4.23\\).\nGenerujte 50 čísel \\(X\\sim\\mathsf{Po}(\\lambda = 2.3)\\).\n\nJaká je pravděpodobnost, že veličina \\(X\\sim\\mathsf{N}(1.3, 4)\\), bude nabývat hodnot menších než 6?"
  },
  {
    "objectID": "06_odhad.html#nestrannost-odhadu",
    "href": "06_odhad.html#nestrannost-odhadu",
    "title": "8  Bodový a intervalový odhad",
    "section": "8.1 Nestrannost odhadu",
    "text": "8.1 Nestrannost odhadu\nV mnoha situacích potřebujeme odhadnout určitý parametr (střední hodnotu, \\(90\\%\\) kvantil atp.) neznámé náhodné veličiny. Tento parametr odhadujeme pomocí nějaké statistiky výběru z této veličiny. Například odhadujeme střední hodnotu veličiny pomocí průměru. Abychom mohli určit hodnotu parametru (např. střední hodnotu) přesně, musel by být výběr nekonečně velký. Jelikož toto v praxi nenastane, náš odhad je vždy více či méně odlišný od skutečné hodnoty parametru (např. střední hodnoty) neznámé veličiny. Důležitou vlastností odhadu je nestrannost - o nestranném odhadu mluvíme pokud střední hodnota odhadu je rovna neznámému parametru.\nV přednáškách o charakteristikách náhodné veličiny a jejich odhadech je zmíněna rovnice\n\\[\n\\dfrac{\\sum\\limits_{i=1}^{n}(x_i - \\bar{x})^2}{n-1}\n\\]\njako nestranný odhad veličiny \\(X\\). Z definice rozptylu \\(\\mathbb{E}[(X - \\mathbb{E}(X^2))]\\) však vyplývá odhad\n\\[\n\\dfrac{\\sum\\limits_{i=1}^{n}(x_i - \\bar{x})^2}{n}.\n\\]\n\n\n\n\n\n\nCvičení\n\n\n\n\nDoplňte následující kód.\n\n\n\n\nKód\nX &lt;- data.frame()\nfor (i in 1:nsim) {\n  x &lt;- rnorm(n)\n  s_unb &lt;- 1/(n-1)\n  s_bia &lt;- 1/n\n  s_unb2 &lt;- 1/(n-1)\n  s_bia2 &lt;- 1/n\n  X &lt;- rbind(X, c(s_unb, s_bia, s_unb2, s_bia2))\n}\nnames(X) = c('UNB', 'BIA' , 'UNB2' ,'BIA2')\n\n\n\nNapište funkce pro odhad ropztylu.\n\nZamyslete se, které proměnné nejsou určeny a doplňte je.\n\nSpočtěte pro každou metodu průměrný odhad a systematickou chybu tohoto odhadu.\n\nKterý odhad je nejméně vychýlený a v jaké situaci?"
  },
  {
    "objectID": "06_odhad.html#bodový-odhad",
    "href": "06_odhad.html#bodový-odhad",
    "title": "8  Bodový a intervalový odhad",
    "section": "8.2 Bodový odhad",
    "text": "8.2 Bodový odhad\nBodovým odhadem se se rozumí jednočíselná hodnota, která reprezentuje vybraný moment statistického souboru jako celek. Bodovým odhadem je například výběrový průměr nebo výběrový rozptyl.\n\n\nKód\nset.seed(100)\nx &lt;- rnorm(10, 10, 10)\nmean(x)\n## [1] 9.820428\nvar(x)\n## [1] 31.48541\n\n\n\n8.2.1 Zákon velkých čísel\nZákon velkých čísel popisuje skutečnost, že s rostoucím počtem opakování nezávislých náhodných pokusů se empirické charakteristiky (realizované výběrové odhady), které popisují výsledky těchto pokusů blíží k teoretickým charakteristikám.\n\n\n\n\n\n\nCvičení\n\n\n\n\nGenerujte s pomocí funkce rnorm postupně \\(10\\), \\(10^2\\), \\(10^3\\), \\(10^4\\) čísel se shodnou střední hodnotou a shodným rozptylem. Spočítejte \\(\\bar{x}\\) a \\({s^2}\\), použijte nápovědu. Okomentujte výsledky.\n\n\n\n\n\n8.2.2 Odhad parametru \\(\\mu\\), neboli střední hodnoty normálního rozdělení s neznámým rozptylem\nTakto formulovaný bodový a intervalový je jednou z nejčastěji prováděných úloh. Nejprve bodovým odhadem zjistíme výběrový průměr souboru.\n\n\nKód\nmean(x)\n\n\n[1] 9.820428\n\n\nVidíme, že \\(x =\\) 4.9780765, 11.3153117, 9.2108291, 18.8678481, 11.1697127, 13.1863009, 4.1820932, 17.1453271, 1.7474057, 6.4013787. Pro tento průmer následně spočítáme interval spolehlivosti."
  },
  {
    "objectID": "06_odhad.html#intervalový-odhad",
    "href": "06_odhad.html#intervalový-odhad",
    "title": "8  Bodový a intervalový odhad",
    "section": "8.3 Intervalový odhad",
    "text": "8.3 Intervalový odhad\nV případech, kdy chceme znát polohu bodového odhadu s nějakou danou pravděpodobností, můžeme se pokusit zkonstruovat tzv. intervalový odhad.\n\\[\n\\bar{X} \\pm \\dfrac{s}{\\sqrt{n}}t_{1-\\alpha/2}(n-1)\n\\]\n\\(100(1-\\alpha)\\%\\) interval spolehlivosti je rozmezí, ve kterém se usuzovaná hodnota základního souboru bude nacházet s určitou pravěděpodobností.\n\n\nKód\nalpha &lt;- 0.05\ncbind(\n  mean(x) - sd(x)/length(x)*qt(p = 1 - alpha/2, df = length(x) - 1),\n  mean(x) + sd(x)/length(x)*qt(p = 1 - alpha/2, df = length(x) - 1)\n)\n\n\n        [,1]     [,2]\n[1,] 8.55109 11.08977"
  },
  {
    "objectID": "06_odhad.html#maximálně-věrohodný-odhad",
    "href": "06_odhad.html#maximálně-věrohodný-odhad",
    "title": "8  Bodový a intervalový odhad",
    "section": "8.4 Maximálně věrohodný odhad",
    "text": "8.4 Maximálně věrohodný odhad\nMaximálně věrohodný odhad je takový, který maximalizuje věrohodnostní funkci \\(L\\) pro výběr \\((x_1, x_2, \\ldots, x_n)\\)\n\\[\nL(\\theta, x_1, x_2, \\ldots, x_n) = p(x_1, \\theta) \\cdot p(x_2, \\theta) \\cdot \\ldots p(x_n, \\theta) = \\prod\\limits_{i=1}^{n}p(x_i, \\theta)\n\\] Konstrukce věrohodnostní funkce\n\n\nKód\n# Set the parameters\nmean_true &lt;- 5\nsd_true &lt;- 1\n\n# Generate random data from a normal distribution\nset.seed(123)\nn &lt;- 10000\nx &lt;- rnorm(n, mean_true, sd_true)\n\n# Define the likelihood function\nlikelihood &lt;- function(params) {\n  mean_param &lt;- params[1]\n  sd_param &lt;- params[2]\n  return(prod(dnorm(x, mean = mean_param, sd = sd_param)))\n}\n\n# Use optim() to find the maximum likelihood estimates\nresult &lt;- optim(par = c(0, 1), fn = function(params) -likelihood(params), hessian = TRUE)\n\n# Maximum Likelihood Estimates\nmle_mean &lt;- result$par[1]\nmle_sd &lt;- result$par[2]\n\ncat(\"MLE for mean:\", mle_mean, \"\\n\")\n\n\nMLE for mean: 0 \n\n\nKód\ncat(\"MLE for standard deviation:\", mle_sd, \"\\n\")\n\n\nMLE for standard deviation: 1 \n\n\nSpočítejte hodnotu věrohodnostní funkce pro \\(X = 4\\)\n\n\nKód\nn &lt;- 10000\nx &lt;- rnorm(n, 5, 1)\nL &lt;- x*pnorm(x, mean = 5, sd = 1)\nmax(L)\n\n\n[1] 8.757954\n\n\nKód\nboxplot(x)\n\n\n\n\n\nKód\ncurve(dnorm(x, 4, 1), xlim = c(0,8))\ncurve(dlnorm(x, 1, 0.5), add = TRUE)"
  },
  {
    "objectID": "06_odhad.html#ttest",
    "href": "06_odhad.html#ttest",
    "title": "8  Bodový a intervalový odhad",
    "section": "8.5 \\(t\\)-test",
    "text": "8.5 \\(t\\)-test\nNejjednodušší aplikací \\(t\\)-testu je Testovací statistika pro oboustrannou alternativu má hodnotu\n\\[\n\\dfrac{|\\bar{x} - \\mu_0|}{s}\\sqrt{n} &gt; t_{\\alpha/2}(n-1)\n\\] a pro jednostrannou alternativu \\(\\mu &gt; \\mu_0\\)\n\\[\n\\dfrac{\\bar{x} - \\mu_0}{s}\\sqrt{n} &gt; t_{\\alpha}(n-1)\n\\] respektive\n\\[\n\\dfrac{\\bar{x} - \\mu_0}{s}\\sqrt{n} &lt; t_{\\alpha}(n-1)\n\\] pro \\(\\mu &lt; \\mu_0\\). \\(n-1\\) je počet stupňů volnosti.\n\n\n\n\n\n\nCvičení\n\n\n\n\nSpočítejte pomocí funkce t.test intervalový odhad pro x = rnorm(100) a set.seed(100).\n\nSpočítejte, zda můžeme s pravděpodobností \\(90\\:\\%\\) zamítnout hypotézu, že střední hodnota veličiny generující výběr x &lt;- c(0.77, 1.11, 1.14, 0.92, 0.49, 5.03, 1.35, 0.94, 0.33, 2.49) je menší než 1.\n\nPro stejný výběr spočítejte, zda je možné na hladině významnosti \\(0.05\\) zamítnout hypotézu, že střední hodnota veličiny generující výběr je rovna \\(1\\)."
  },
  {
    "objectID": "07_testovani.html#postup-testování-statistické-hypotézy",
    "href": "07_testovani.html#postup-testování-statistické-hypotézy",
    "title": "9  Testování hypotéz",
    "section": "9.1 Postup testování statistické hypotézy:",
    "text": "9.1 Postup testování statistické hypotézy:\n\nFormulace nulové \\(H_0\\) a alternativní \\(H_a\\) hypotézy.\n\nVolba hladiny významnosti \\(\\alpha\\).\n\nVolba testovací statistiky.\n\nUrčení kritického oboru testové statistiky\n\n\nVýsledkem testování je buď a) zamítnutní nulové hypotézy1 b) nezamítnutní nulové hypotézy."
  },
  {
    "objectID": "07_testovani.html#p-hodnota",
    "href": "07_testovani.html#p-hodnota",
    "title": "9  Testování hypotéz",
    "section": "9.2 P-hodnota",
    "text": "9.2 P-hodnota\nMísto porovnání hodnoty testovacího kritéria s kritickými hodnotami lze pro rozhodování o platnosti či neplatnosti nulové hypotézy použít i tzv. p-hodnotu (anglicky p-value). Definice p-hodnoty je poněkud obšírná - jedná se o odhad pravděpodobnosti, že daný výsledek nebo výsledek, který je ještě extrémnější než ten pozorovaný, mohl nastat náhodou, za předpokladu, že nulová hypotéza je pravdivá."
  },
  {
    "objectID": "07_testovani.html#alpha-interval-spolehlivosti",
    "href": "07_testovani.html#alpha-interval-spolehlivosti",
    "title": "9  Testování hypotéz",
    "section": "9.3 \\(100(1-\\alpha)\\%\\) interval spolehlivosti",
    "text": "9.3 \\(100(1-\\alpha)\\%\\) interval spolehlivosti\n\\[\n\\bar{x} - 1.96\\dfrac{\\sigma}{\\sqrt{n}}\\leq\\mu\\leq \\bar{x} + 1.96\\dfrac{\\sigma}{\\sqrt{n}}\n\\]\n\\[\n\\bar{x} - t_{1-\\alpha/2(\\nu)}\\dfrac{\\sigma}{\\sqrt{n}}\\leq\\mu\\leq \\bar{x} + t_{1-\\alpha/2(\\nu)}\\dfrac{\\sigma}{\\sqrt{n}}\n\\]\nkde \\(\\nu=n-1\\) je počet stupňů volnosti.\nPravděpodobnost platnosti hypotézy"
  },
  {
    "objectID": "07_testovani.html#footnotes",
    "href": "07_testovani.html#footnotes",
    "title": "9  Testování hypotéz",
    "section": "",
    "text": "Zamítnutí nulové hypotézy neznamená, že nulová hypotéza neplatí, ale znamená to, že data nevykazují objektivní důvody k jejímu přijetí↩︎"
  },
  {
    "objectID": "09_casove_rady.html#autokorelační-funkce",
    "href": "09_casove_rady.html#autokorelační-funkce",
    "title": "10  Časové řady",
    "section": "10.1 Autokorelační funkce",
    "text": "10.1 Autokorelační funkce\nACF slouží k posouzení, zda časová řada obsahuje cyklickou či periodickou složku a také, zda je či není řadou náhodnýhc čísel. Graficky je vyjádřena pomocí korelogramu.\n\n\nKód\npar(mfrow = c(1, 2))\nacf(dataset$R)\nacf(co2)\n\n\n\n\n\nVlevo řada se silnou autokorelací složek bez znatelené periodicity, vpravo dtto s periodickou složkou"
  },
  {
    "objectID": "09_casove_rady.html#dekompozice-časové-řady",
    "href": "09_casove_rady.html#dekompozice-časové-řady",
    "title": "10  Časové řady",
    "section": "10.2 Dekompozice časové řady",
    "text": "10.2 Dekompozice časové řady\nDekompozicí časové řady rozumíme rozklad na složky:\n\nTrendovou \\(T_t\\)\nSezónní \\(S_t\\)\nCyklickou \\(C_t\\)\nNáhodnou \\(\\epsilon_t\\)\n\n\n10.2.1 Aditivní dekompozice\nPředpokládáme, že řadu lze rozložit na součet složek\n\\[\nY_t =T_t +S_t +C_t +\\epsilon_t,\n\\]\n\n\nKód\ndec_co2 &lt;- decompose(co2)\nplot(dec_co2)\n\n\n\n\n\nKód\nplot(dec_co2$trend)\n\n\n\n\n\n\n\n10.2.2 Residua\nOvěřte, zda po dekompozici co2 residua \\(\\epsilon_t\\) splňují definici bílého šumu tzn. mají nulovou střední hodnotu a konečný rozptyl a jsou nekorelované.\n\n\nKód\nshapiro.test(dec_co2$random)\n\n\n\n    Shapiro-Wilk normality test\n\ndata:  dec_co2$random\nW = 0.99506, p-value = 0.1549\n\n\nKód\nmean(dec_co2$random, na.rm = TRUE)\n\n\n[1] 0.001743421\n\n\nKód\nvar(dec_co2$random, na.rm = TRUE)\n\n\n[1] 0.07028142\n\n\nKód\n# ..."
  },
  {
    "objectID": "09_casove_rady.html#zhlazovací-funkce",
    "href": "09_casove_rady.html#zhlazovací-funkce",
    "title": "10  Časové řady",
    "section": "10.3 Zhlazovací funkce",
    "text": "10.3 Zhlazovací funkce\n\n\nKód\npar(mfrow = c(1, 2))\nplot(dataset$Tmin, type = \"l\", \n     col = \"slategray\", \n     lwd = 0.5)\nmd1 &lt;- loess(Tmin ~ na.omit(1:length(dataset$Tmin)), \n             data = dataset, \n             degree = 1)\nlines(md1$fitted, col = \"orangered\")\n\nplot(filter(x = dataset$R, \n             method = \"convolution\", \n             filter = c(rep(1/365.25, 365.25)), \n             sides = 1), \n      col = \"dodgerblue3\", \n     type = \"l\")\n\n\n\n\n\n\n\nKód\nmd2 &lt;- lm(Tmin ~ DTM, data = dataset)\nplot(dataset$Tmin, type = \"l\", \n     col = \"slategray\", \n     lwd = 0.5)\nlines(md1$fitted, col = \"darkred\")\nabline(coef(md2), col = \"orangered\")"
  },
  {
    "objectID": "10_hydro_index.html#odtokový-součinitel",
    "href": "10_hydro_index.html#odtokový-součinitel",
    "title": "11  Hydroklimatické indexy",
    "section": "11.1 Odtokový součinitel",
    "text": "11.1 Odtokový součinitel"
  },
  {
    "objectID": "10_hydro_index.html#základní-odtok",
    "href": "10_hydro_index.html#základní-odtok",
    "title": "11  Hydroklimatické indexy",
    "section": "11.2 Základní odtok",
    "text": "11.2 Základní odtok"
  },
  {
    "objectID": "10_hydro_index.html#index-předchozích-srážek",
    "href": "10_hydro_index.html#index-předchozích-srážek",
    "title": "11  Hydroklimatické indexy",
    "section": "11.3 Index předchozích srážek",
    "text": "11.3 Index předchozích srážek"
  },
  {
    "objectID": "10_hydro_index.html#section",
    "href": "10_hydro_index.html#section",
    "title": "11  Hydroklimatické indexy",
    "section": "11.4 ",
    "text": "11.4 \n\n\nKód\nx &lt;- rnorm(n = 10, mean = 1.25, sd = 5.36)\nmean(x)\n\n\n[1] -0.2148586\n\n\nKód\nsum(x)\n\n\n[1] -2.148586\n\n\nKód\nmedian(x)\n\n\n[1] 0.0641445\n\n\nKód\nIQR(x)\n\n\n[1] 7.619288\n\n\nKód\nfivenum(x)\n\n\n[1] -8.8504344 -4.0589773  0.0641445  4.1208867 11.1641536"
  },
  {
    "objectID": "10_hydro_index.html#spojitá-rozdělení",
    "href": "10_hydro_index.html#spojitá-rozdělení",
    "title": "11  Hydroklimatické indexy",
    "section": "11.5 Spojitá rozdělení",
    "text": "11.5 Spojitá rozdělení\n\n\nKód\ncurve(sin(x))"
  },
  {
    "objectID": "11_korelace_regrese.html#sec-korelace",
    "href": "11_korelace_regrese.html#sec-korelace",
    "title": "12  Závislost dvou veličin",
    "section": "12.1 Korelace",
    "text": "12.1 Korelace\nKorelace je vztah mezi dvěma náhodnými veličinami. Zkoumá, zda se jedna ze zkoumaných veličin mění, pokud se zároveň mění i druhá.Korelace nezkoumá příčinnost, nelze tedy jednoznačně určit závislou a nezávislou proměnnou.\nMíru korelace dvou veličin posuzujeme korelačním koeficientem. V případe normality u obou veličin lze použít Paersonův korelační koeficient,\n\\[\nr_{xy} = \\dfrac{\\sum(x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum(x_i - \\bar{x})^2}\\sqrt{\\sum(y_i - \\bar{y})^2}}\n\\tag{12.1}\\]\npřičemž platí \\(r_{xy}\\in\\langle-1;1\\rangle\\). Alternativně můžeme použít neparametrický výpočet Spearmana, založený na diferencích pořadí pozorovaných hodnot, které definujeme jako \\(d_i = x_{ri} - y_{ri}\\)\n\\[\n\\rho = r_s = 1 - \\dfrac{6\\sum_{i=1}^{n}d_i^2}{n(n^2-1)}\n\\tag{12.2}\\]\n\n\n\n\n\n\nCvičení\n\n\n\n\nNapište vlastní funkci, které pro dané vektory x a y spočítá korelační Spearmanův koeficient.\n\n\n\nNejprve je nutné identifikovat pořadí,\n\ndále spočítat kvadrát vzdáleností,\n\na po dosazení počtu měření \\(n\\) dosadit do rovnice.\n\n\n\nVyzkoušejte obě funkce na datech\n\nŘešení:\n\n\n\nKód\nsp_k &lt;- function(x, y) {\n  rank_x &lt;- rank(x) \n  rank_y &lt;- rank(y) \n  d &lt;- rank_x - rank_y \n  d_sq &lt;- sum(d^2) \n  n &lt;- length(x) \n  1 - ((6 * d_sq) / (n*(n^2 - 1))) \n}\n\n\n\n\nKód\nsp_k(_, _)\ncor(_, _, method = \"Spearman\")\n\n\n\nPokuste se odhadnout korelační koeficient následujících veličin\n\n\n\n\n\n\n\n\n\n\n\n\npairs()"
  },
  {
    "objectID": "11_korelace_regrese.html#kovariance",
    "href": "11_korelace_regrese.html#kovariance",
    "title": "12  Závislost dvou veličin",
    "section": "12.2 Kovariance",
    "text": "12.2 Kovariance"
  },
  {
    "objectID": "11_korelace_regrese.html#regresní-model",
    "href": "11_korelace_regrese.html#regresní-model",
    "title": "12  Závislost dvou veličin",
    "section": "12.3 Regresní model",
    "text": "12.3 Regresní model\nNarozdíl od korelace, v regresní analýze sledujeme příčinnou závislost. Identifikujeme nezávislou proměnnou a závislou proměnnou. Míru závislosti posuzujeme pomocí lineárního regresního modelu. Cílem regrese je proložit naměřenými body přímku, která nejlépe vystihuje vztah mezi proměnnými.\n\\[\ny = \\beta_0 + \\beta_1x\n\\] kde \\(y\\) je závislá proměnná, \\(x\\) je nezávislá proměnná, \\(\\beta_0\\) je počátek (intercept) a \\(\\beta_1\\) je sklon přímky.\nLineární model regresního typu definujeme v R pomocí funkce lm(), které na první pozici dosazujeme výraz ve formátu rovnice formula, např. lm(y ~ x). Model vyhodnocujeme funkcí summary a mezi sebou porovnáváme pomocí kritérií zohledňující vysvětlenou variabilitu/věrohodnost modelu a jeho komplexnost, např. Akaikeho informační kritérium.\n\\[\n\\text{AIC} = 2k - 2\\ln(\\hat{L})\n\\] kde \\(k\\) je počet volných parametrů modelu a \\(\\hat{L}\\) je věrohodnostní funkce modelu.\n\nCvičení\n\nUvažujme následující data, kde předpokládáme příčinnou závislost \\(y\\) na \\(x\\).\n\n\n\nKód\ndfr &lt;- data.frame(\n  x &lt;- c( 3.93,  3.83,  7.11,  6.98,  7.87,  9.11, 10.04,  9.99, 10.11, 10.93, \n         11.01, 11.93, 11.94, 11.88, 11.82, 12.98, 13.04, 13.04, 13.11, 13.99, \n         13.97, 13.99, 13.97, 15.08, 14.93, 14.86, 15.89, 16.15, 17.08, 17.18, \n         16.96, 17.95, 18.14, 18.09, 18.05, 19.04, 19.08, 19.07, 20.11, 20, \n         20,    20.14, 19.92, 22.13, 23.09, 23.9 , 23.95, 24.06, 23.95, 24.94\n  ),\n  y &lt;- c( 1.93, 10.01,  3.73, 22.09, 15.86, 10.09, 18.09, 25.91, 34.09, 16.89, \n         28.04, 13.95, 19.98, 23.98, 27.78, 26.19, 33.85, 33.96, 45.88, 25.96, \n         35.89, 60.  , 80.03, 20.06, 25.92, 54.03, 31.96, 40.12, 32.03, 39.95, \n         50.2 , 41.91, 55.92, 75.92, 83.89, 35.94, 45.94, 67.85, 32.05, 48.11, \n         52.11, 55.95, 64.02, 65.9 , 53.94, 69.92, 92.1 , 92.78, 99.03, 85.09)\n)\n\n\n\nSestrojme lineární model md1\n\n\n\nKód\nmd1 &lt;- lm(formula = y ~ x, data = dfr)\n\n\n\nStruktura objektu md1 je komplexní, můžeme vybírat jednotlivé proměnné k dalším účelům, například pro tvorbu grafů.\n\n\n\nKód\nstr(md1, 1)\n\n\nList of 12\n $ coefficients : Named num [1:2] -15.72 3.78\n  ..- attr(*, \"names\")= chr [1:2] \"(Intercept)\" \"x\"\n $ residuals    : Named num [1:50] 2.79 11.25 -7.43 11.42 1.82 ...\n  ..- attr(*, \"names\")= chr [1:50] \"1\" \"2\" \"3\" \"4\" ...\n $ effects      : Named num [1:50] -300.7778 140.5186 -9.3636 9.458 0.0675 ...\n  ..- attr(*, \"names\")= chr [1:50] \"(Intercept)\" \"x\" \"\" \"\" ...\n $ rank         : int 2\n $ fitted.values: Named num [1:50] -0.862 -1.24 11.163 10.672 14.037 ...\n  ..- attr(*, \"names\")= chr [1:50] \"1\" \"2\" \"3\" \"4\" ...\n $ assign       : int [1:2] 0 1\n $ qr           :List of 5\n  ..- attr(*, \"class\")= chr \"qr\"\n $ df.residual  : int 48\n $ xlevels      : Named list()\n $ call         : language lm(formula = y ~ x, data = dfr)\n $ terms        :Classes 'terms', 'formula'  language y ~ x\n  .. ..- attr(*, \"variables\")= language list(y, x)\n  .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. ..- attr(*, \"term.labels\")= chr \"x\"\n  .. ..- attr(*, \"order\")= int 1\n  .. ..- attr(*, \"intercept\")= int 1\n  .. ..- attr(*, \"response\")= int 1\n  .. ..- attr(*, \".Environment\")=&lt;environment: R_GlobalEnv&gt; \n  .. ..- attr(*, \"predvars\")= language list(y, x)\n  .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. ..- attr(*, \"names\")= chr [1:2] \"y\" \"x\"\n $ model        :'data.frame':  50 obs. of  2 variables:\n  ..- attr(*, \"terms\")=Classes 'terms', 'formula'  language y ~ x\n  .. .. ..- attr(*, \"variables\")= language list(y, x)\n  .. .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..- attr(*, \"term.labels\")= chr \"x\"\n  .. .. ..- attr(*, \"order\")= int 1\n  .. .. ..- attr(*, \"intercept\")= int 1\n  .. .. ..- attr(*, \"response\")= int 1\n  .. .. ..- attr(*, \".Environment\")=&lt;environment: R_GlobalEnv&gt; \n  .. .. ..- attr(*, \"predvars\")= language list(y, x)\n  .. .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. .. ..- attr(*, \"names\")= chr [1:2] \"y\" \"x\"\n - attr(*, \"class\")= chr \"lm\"\n\n\n\n\nKód\nwith(data = dfr, \n     expr = plot(x, \n                 y, \n                 xlim = c(0, 30), \n                 ylim = c(md1$coefficients[1], \n                          max(md1$fitted.values) + 2)))\nabline(md1$coefficients, col = \"orangered\")\nabline(v = 0, lty = \"dashed\")\nabline(h = md1$coefficients[1], lty = \"dashed\")\n\n\n\n\n\n\nModel vyhodnotíme pomocí summary\n\n\n\nKód\nsummary(md1)\n\n\n\nCall:\nlm(formula = y ~ x, data = dfr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-28.274  -9.410  -1.639  10.063  42.925 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -15.7241     6.3224  -2.487   0.0164 *  \nx             3.7816     0.3884   9.736 6.03e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.43 on 48 degrees of freedom\nMultiple R-squared:  0.6639,    Adjusted R-squared:  0.6568 \nF-statistic: 94.79 on 1 and 48 DF,  p-value: 6.032e-13\n\n\nSouhrn obsahuje původní zadání v podobě rovnice, dále identifikované koeficienty modelu, významnost závislosti indikuje přítomnost jedné nebo více * u vysvětlující proměnné; dále lze vyčíst podíl vysvětlené variabiltiy Adjusted R-squared:  0.6417.\n\n\n\nKód\npar(mfrow = c(2, 2))\nplot(md1, 1:4)\n\n\n\n\n\nR dále poskytuje grafické nástroje k posouzení vhodnosti zvoleného modelu. Zde nás budou zajímat zejména residua modelu. Dle prvního grafu by mohl model se závislostí na polynomu být lepší volbou.\n\nPokusme se sestavit alternativní model s kvadratickou vysvětlující proměnnou.\n\n\nKód\nmd2 &lt;- lm(y ~ poly(x, 2))\nsummary(md2)\n\n\n\nCall:\nlm(formula = y ~ poly(x, 2))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-28.086  -9.010  -3.459   4.693  45.048 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   42.536      2.027  20.985  &lt; 2e-16 ***\npoly(x, 2)1  140.519     14.333   9.804 6.05e-13 ***\npoly(x, 2)2   18.519     14.333   1.292    0.203    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.33 on 47 degrees of freedom\nMultiple R-squared:  0.6754,    Adjusted R-squared:  0.6616 \nF-statistic: 48.89 on 2 and 47 DF,  p-value: 3.29e-12\n\n\n\n\nKód\npar(mfrow = c(2, 2))\nplot(md2, 1:4)\n\n\n\n\n\n\n\nKód\nwith(data = dfr, \n     expr = plot(x, y, xlim = c(0, 30)))\npred &lt;- predict(md2)\nix &lt;- sort(dfr$x, index.return=T)$ix\nlines(x[ix], pred[ix], col = 'orangered')\n\n\n\n\n\nSrovnejme modely vzájemně\n\n\nKód\nAIC(md1, md2)\n\n\n    df      AIC\nmd1  3 412.8013\nmd2  4 413.0561\n\n\n\n\n\n\n\n\nCvičení\n\n\n\n\nProzkoumejte závislost odtoku na velikosti povodí \n\n\n\n\n\n\n\n\n\n\n\n\n\nPovodí\nvelikost \\(x_i\\)\npořadí\nodtok \\(y_i\\)\npořadí\nrozdíl \\(d_i\\)\n\\(d_i^2\\)\n\n\n\n\n1\n\n\n\n\n\n\n\n\n2\n\n\n\n\n\n\n\n\n3\n\n\n\n\n\n\n\n\n4\n\n\n\n\n\n\n\n\n5\n\n\n\n\n\n\n\n\n6\n\n\n\n\n\n\n\n\n7\n\n\n\n\n\n\n\n\n8\n\n\n\n\n\n\n\n\n9\n\n\n\n\n\n\n\n\n10"
  },
  {
    "objectID": "12_extremalni_rozdeleni.html#weibullovo-rozdělení",
    "href": "12_extremalni_rozdeleni.html#weibullovo-rozdělení",
    "title": "13  Extremální rozdělení",
    "section": "13.1 Weibullovo rozdělení",
    "text": "13.1 Weibullovo rozdělení\nKorelace je vztah mezi dvěma náhodnými veličinami. Zkoumá, zda se jedna ze zkoumaných veličin mění, pokud se zároveň mění i druhá.Korelace nezkoumá příčinnost, nelze tedy jednoznačně určit závislou a nezávislou proměnnou.\nMíru korelace dvou veličin posuzujeme korelačním koeficientem. V případe normality u obou veličin lze použít Paersonův korelační koeficient,\n\\[\nr_{xy} = \\dfrac{\\sum(x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum(x_i - \\bar{x})^2}\\sqrt{\\sum(y_i - \\bar{y})^2}}\n\\] přičemž platí \\(r_{xy}\\in\\langle-1;1\\rangle\\). Alternativně můžeme použít neparametrický výpočet Spearmana, založený na diferencích pořadí pozorovaných hodnot, které definujeme jako \\(d_i = x_{ri} - y_{ri}\\)\n\\[\n\\rho = r_s = 1 - \\dfrac{6\\sum_{i=1}^{n}d_i^2}{n(n^2-1)}\n\\tag{13.1}\\]\n\nCvičení\n\nNapište vlastní funkci, které pro dané vektory x a y spočítá korelační Spearmanův koeficient.\nŘešení:\n\n\n\nKód\nsp_k &lt;- function(x, y) {\n1  rank_x &lt;- rank(x)\n  rank_y &lt;- rank(y)\n2  d &lt;- rank_x - rank_y\n  d_sq &lt;- sum(d^2)\n3  n &lt;- length(x)\n  \n  1 - ((6 * d_sq) / (n*(n^2 - 1)))\n  \n}\n\n\n\n1\n\nNejprve je nutné identifikovat pořadí,\n\n2\n\ndále spočítat kvadrát vzdáleností,\n\n3\n\na po dosazení počtu měření \\(n\\) dosadit do rovnice.\n\n\n\n\n\nPorovnejte obě funkce na datech\n\n\n\nKód\nsp_k(_, _)\ncor(_, _, method = \"Spearman\")\n\n\n\nPokuste se odhadnout korelační koeficient následujících veličin\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPovodí\nvelikost \\(x_i\\)\npořadí\nodtok \\(y_i\\)\npořadí\nrozdíl \\(d_i\\)\n\\(d_i^2\\)\n\n\n\n\n1\n\n\n\n\n\n\n\n\n2\n\n\n\n\n\n\n\n\n3\n\n\n\n\n\n\n\n\n4\n\n\n\n\n\n\n\n\n5\n\n\n\n\n\n\n\n\n6\n\n\n\n\n\n\n\n\n7\n\n\n\n\n\n\n\n\n8\n\n\n\n\n\n\n\n\n9\n\n\n\n\n\n\n\n\n10"
  },
  {
    "objectID": "12_extremalni_rozdeleni.html#regrese",
    "href": "12_extremalni_rozdeleni.html#regrese",
    "title": "13  Extremální rozdělení",
    "section": "13.2 Regrese",
    "text": "13.2 Regrese\nNarozdíl od korelace, v regresní analýze sledujeme příčinnou závislost. Identifikujeme nezávislou proměnnou a závislou proměnnou. Míru závislosti posuzujeme pomocí lineárního regresního modelu. Cílem regrese je proložit naměřenými body přímku, která nejlépe vystihuje vztah mezi proměnnými.\n\\[\ny = \\beta_0 + \\beta_1x\n\\] kde \\(y\\) je závislá proměnná, \\(x\\) je nezávislá proměnná, \\(\\beta_0\\) je počátek (intercept) a \\(\\beta_1\\) je sklon přímky.\nLineární model regresního typu definujeme v R pomocí funkce lm(), které na první pozici dosazujeme výraz ve formátu rovnice formula, např. lm(y ~ x). Model vyhodnocujeme funkcí summary a mezi sebou porovnáváme pomocí kritérií zohledňující vysvětlenou variabilitu/věrohodnost modelu a jeho komplexnost, např. Akaikeho informační kritérium.\n\\[\n\\text{AIC} = 2k - 2\\ln(\\hat{L})\n\\] kde \\(k\\) je počet volných parametrů modelu a \\(\\hat{L}\\) je věrohodnostní funkce modelu.\n\nCvičení\n\nUvažujme následující data, kde předpokládáme příčinnou závislost \\(y\\) na \\(x\\).\n\n\n\nKód\ndfr &lt;- data.frame(\n  x &lt;- c( 3.93,  3.83,  7.11,  6.98,  7.87,  9.11, 10.04,  9.99, 10.11, 10.93, \n         11.01, 11.93, 11.94, 11.88, 11.82, 12.98, 13.04, 13.04, 13.11, 13.99, \n         13.97, 13.99, 13.97, 15.08, 14.93, 14.86, 15.89, 16.15, 17.08, 17.18, \n         16.96, 17.95, 18.14, 18.09, 18.05, 19.04, 19.08, 19.07, 20.11, 20, \n         20,    20.14, 19.92, 22.13, 23.09, 23.9 , 23.95, 24.06, 23.95, 24.94\n  ),\n  y &lt;- c( 1.93, 10.01,  3.73, 22.09, 15.86, 10.09, 18.09, 25.91, 34.09, 16.89, \n         28.04, 13.95, 19.98, 23.98, 27.78, 26.19, 33.85, 33.96, 45.88, 25.96, \n         35.89, 60.  , 80.03, 20.06, 25.92, 54.03, 31.96, 40.12, 32.03, 39.95, \n         50.2 , 41.91, 55.92, 75.92, 83.89, 35.94, 45.94, 67.85, 32.05, 48.11, \n         52.11, 55.95, 64.02, 65.9 , 53.94, 69.92, 92.1 , 92.78, 99.03, 85.09)\n)\n\n\n\nSestrojme lineární model md1\n\n\n\nKód\nmd1 &lt;- lm(formula = y ~ x, data = dfr)\n\n\n\nStruktura objektu md1 je komplexní, můžeme vybírat jednotlivé proměnné k dalším účelům, například pro tvorbu grafů.\n\n\n\nKód\nstr(md1, 1)\n\n\nList of 12\n $ coefficients : Named num [1:2] -15.72 3.78\n  ..- attr(*, \"names\")= chr [1:2] \"(Intercept)\" \"x\"\n $ residuals    : Named num [1:50] 2.79 11.25 -7.43 11.42 1.82 ...\n  ..- attr(*, \"names\")= chr [1:50] \"1\" \"2\" \"3\" \"4\" ...\n $ effects      : Named num [1:50] -300.7778 140.5186 -9.3636 9.458 0.0675 ...\n  ..- attr(*, \"names\")= chr [1:50] \"(Intercept)\" \"x\" \"\" \"\" ...\n $ rank         : int 2\n $ fitted.values: Named num [1:50] -0.862 -1.24 11.163 10.672 14.037 ...\n  ..- attr(*, \"names\")= chr [1:50] \"1\" \"2\" \"3\" \"4\" ...\n $ assign       : int [1:2] 0 1\n $ qr           :List of 5\n  ..- attr(*, \"class\")= chr \"qr\"\n $ df.residual  : int 48\n $ xlevels      : Named list()\n $ call         : language lm(formula = y ~ x, data = dfr)\n $ terms        :Classes 'terms', 'formula'  language y ~ x\n  .. ..- attr(*, \"variables\")= language list(y, x)\n  .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. ..- attr(*, \"term.labels\")= chr \"x\"\n  .. ..- attr(*, \"order\")= int 1\n  .. ..- attr(*, \"intercept\")= int 1\n  .. ..- attr(*, \"response\")= int 1\n  .. ..- attr(*, \".Environment\")=&lt;environment: R_GlobalEnv&gt; \n  .. ..- attr(*, \"predvars\")= language list(y, x)\n  .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. ..- attr(*, \"names\")= chr [1:2] \"y\" \"x\"\n $ model        :'data.frame':  50 obs. of  2 variables:\n  ..- attr(*, \"terms\")=Classes 'terms', 'formula'  language y ~ x\n  .. .. ..- attr(*, \"variables\")= language list(y, x)\n  .. .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n  .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..- attr(*, \"term.labels\")= chr \"x\"\n  .. .. ..- attr(*, \"order\")= int 1\n  .. .. ..- attr(*, \"intercept\")= int 1\n  .. .. ..- attr(*, \"response\")= int 1\n  .. .. ..- attr(*, \".Environment\")=&lt;environment: R_GlobalEnv&gt; \n  .. .. ..- attr(*, \"predvars\")= language list(y, x)\n  .. .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"numeric\"\n  .. .. .. ..- attr(*, \"names\")= chr [1:2] \"y\" \"x\"\n - attr(*, \"class\")= chr \"lm\"\n\n\n\n\nKód\nwith(data = dfr, \n     expr = plot(x, \n                 y, \n                 xlim = c(0, 30), \n                 ylim = c(md1$coefficients[1], \n                          max(md1$fitted.values) + 2)))\nabline(md1$coefficients, col = \"orangered\")\nabline(v = 0, lty = \"dashed\")\nabline(h = md1$coefficients[1], lty = \"dashed\")\n\n\n\n\n\n\nModel vyhodnotíme pomocí summary\n\n\n\nKód\nsummary(md1)\n\n\n\nCall:\nlm(formula = y ~ x, data = dfr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-28.274  -9.410  -1.639  10.063  42.925 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -15.7241     6.3224  -2.487   0.0164 *  \nx             3.7816     0.3884   9.736 6.03e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.43 on 48 degrees of freedom\nMultiple R-squared:  0.6639,    Adjusted R-squared:  0.6568 \nF-statistic: 94.79 on 1 and 48 DF,  p-value: 6.032e-13\n\n\nSouhrn obsahuje původní zadání v podobě rovnice, dále identifikované koeficienty modelu, významnost závislosti indikuje přítomnost jedné nebo více * u vysvětlující proměnné; dále lze vyčíst podíl vysvětlené variabiltiy Adjusted R-squared:  0.6417.\n\n\n\nKód\npar(mfrow = c(2, 2))\nplot(md1, 1:4)\n\n\n\n\n\nR dále poskytuje grafické nástroje k posouzení vhodnosti zvoleného modelu. Zde nás budou zajímat zejména residua modelu. Dle prvního grafu by mohl model se závislostí na polynomu být lepší volbou.\n\nPokusme se sestavit alternativní model s kvadratickou vysvětlující proměnnou.\n\n\nKód\nmd2 &lt;- lm(y ~ poly(x, 2))\nsummary(md2)\n\n\n\nCall:\nlm(formula = y ~ poly(x, 2))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-28.086  -9.010  -3.459   4.693  45.048 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   42.536      2.027  20.985  &lt; 2e-16 ***\npoly(x, 2)1  140.519     14.333   9.804 6.05e-13 ***\npoly(x, 2)2   18.519     14.333   1.292    0.203    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.33 on 47 degrees of freedom\nMultiple R-squared:  0.6754,    Adjusted R-squared:  0.6616 \nF-statistic: 48.89 on 2 and 47 DF,  p-value: 3.29e-12\n\n\n\n\nKód\npar(mfrow = c(2, 2))\nplot(md2, 1:4)\n\n\n\n\n\n\n\nKód\nwith(data = dfr, \n     expr = plot(x, y, xlim = c(0, 30)))\npred &lt;- predict(md2)\nix &lt;- sort(dfr$x, index.return=T)$ix\nlines(x[ix], pred[ix], col = 'orangered')\n\n\n\n\n\nSrovnejme modely vzájemně\n\n\nKód\nAIC(md1, md2)\n\n\n    df      AIC\nmd1  3 412.8013\nmd2  4 413.0561\n\n\n\nPokuste se vést diskuzi nad vhodností obou modelů"
  }
]